<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 3.2.0">
  <meta name="generator" content="Hugo 0.53" />
  <meta name="author" content="Renato Valladares Panaro">

  
  
  
  
    
  
  <meta name="description" content="Semiparametric Survival Modelling via Bernstein Polynomials.">

  
  <link rel="alternate" hreflang="en-us" href="/project/internal-project/">

  


  

  

  

  

  

  

  
  
  
  <meta name="theme-color" content="#4472c4">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha256-eSi1q2PG6J7g7ib17yAaWMcrr5GrtohYChqibrV7PBE=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css" integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" crossorigin="anonymous">
        
      
    

    

    

  

  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700|Merriweather|Roboto+Mono">
  

  <link rel="stylesheet" href="/styles.css">
  

  
  
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="rvpanaro">
  <link rel="feed" href="/index.xml" type="application/rss+xml" title="rvpanaro">
  

  <link rel="manifest" href="/site.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/project/internal-project/">

  
  
  
  
    
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="og:site_name" content="rvpanaro">
  <meta property="og:url" content="/project/internal-project/">
  <meta property="og:title" content="phbp | rvpanaro">
  <meta property="og:description" content="Semiparametric Survival Modelling via Bernstein Polynomials."><meta property="og:image" content="/project/internal-project/featured.jpg">
  <meta property="og:locale" content="en-us">
  
  <meta property="article:published_time" content="2019-01-04T14:24:00-02:00">
  
  <meta property="article:modified_time" content="2019-01-04T14:24:00-02:00">
  

  

  

  <title>phbp | rvpanaro</title>

</head>
<body id="top" data-spy="scroll" data-target="#TableOfContents" data-offset="71" >
  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/"><img src="/img/logo.png" alt="rvpanaro"></a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav mr-auto">
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#about">
            
            <span>About</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#projects">
            
            <span>Projects</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#publications">
            
            <span>Papers</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
        

        <li class="nav-item">
          <a class="nav-link" href="/#contact">
            
            <span>Contact</span>
            
          </a>
        </li>

        
        

        

        
        
        
          
            
          
        

        <li class="nav-item">
          <a class="nav-link" href="http://rn00bs.com.br/" target="_blank" rel="noopener">
            
            <span>RN00bs</span>
            
          </a>
        </li>

        
        

      

        

        

        

        

      </ul>

    </div>
  </div>
</nav>


<article class="article article-project" itemscope itemtype="http://schema.org/Article">

  













<div class="article-header d-xl-none">
  <img src="/project/internal-project/featured_hu5aa07bb4f7faf93893d27114265ce0cc_55786_1600x400_fill_q90_box_smart1.jpg" class="article-banner" itemprop="image" alt="">
  <span class="article-header-caption">copyright image</span>
</div>


<div class="container-fluid split-header d-none d-xl-block">
  <div class="row">
    <div class="col-6">
      <div class="split-header-content">
        <h1 itemprop="name">phbp</h1>

        

        

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Renato Valladares Panaro">
  </span>
  

  <span class="article-date">
    
    <meta content="2019-01-04 14:24:00 -0200 -02" itemprop="datePublished">
    <time datetime="2019-01-04 14:24:00 -0200 -02" itemprop="dateModified">
      4 Jan, 2019
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Renato Valladares Panaro">
  </span>

  

  
  

  

  

</div>


        







  








<div class="btn-links mb-3">
  
  






  



  







<a class="btn btn-outline-primary my-1 mr-1" href="https://github.com/rvpanaro/phbp" target="_blank" rel="noopener">
  Code
</a>













  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary my-1 mr-1" href="https://github.com/rvpanaro/" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>
    Follow
  </a>


</div>



        

      </div>
    </div>
    <div class="col-6">
      <div class="split-header-image">
        <img src="/project/internal-project/featured_hu5aa07bb4f7faf93893d27114265ce0cc_55786_680x500_fill_q90_box_smart1.jpg" itemprop="image" alt="">
        <span class="article-header-caption">copyright image</span>
      </div>
    </div>
  </div>
</div>

<div class="article-container d-xl-none">
  <h1 itemprop="name">phbp</h1>

  

  

<div class="article-metadata">

  
  
  <span itemscope itemprop="author" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Renato Valladares Panaro">
  </span>
  

  <span class="article-date">
    
    <meta content="2019-01-04 14:24:00 -0200 -02" itemprop="datePublished">
    <time datetime="2019-01-04 14:24:00 -0200 -02" itemprop="dateModified">
      4 Jan, 2019
    </time>
  </span>
  <span itemscope itemprop="publisher" itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Renato Valladares Panaro">
  </span>

  

  
  

  

  
  

  

</div>


  







  








<div class="btn-links mb-3">
  
  






  



  







<a class="btn btn-outline-primary my-1 mr-1" href="https://github.com/rvpanaro/phbp" target="_blank" rel="noopener">
  Code
</a>













  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary my-1 mr-1" href="https://github.com/rvpanaro/" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>
    Follow
  </a>


</div>


</div>



  <div class="article-container">

    <div class="article-style" itemprop="articleBody">
      

<p><strong>phbp</strong> project aims to present base risk estimate and related functions based on Proportional Hazards Models using Bernstein Polynomials (BP). For this, a demo was made making use of <code>larynx</code> dataset available at <strong>KMSurv</strong> Rpackage. Most relevent results were briefly explained and displayed throughout this text.</p>

<ul class="task-list">
<li><label><input type="checkbox" checked disabled class="task-list-item"> Survival analysis</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Bernstein polynomials</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Adaptive rejection metropolis sampling within gibbs sampling</label></li>
<li><label><input type="checkbox" checked disabled class="task-list-item"> Jacobian Method</label></li>
</ul>

<h2 id="cox-proportional-hazards-ph-model-partial-likelihood">Cox Proportional Hazards (PH) model (partial likelihood)</h2>

<p>First, we fitted gold standard Cox model. Due to avoid overflow in the argument to the exponential function, centered but not scaled data were used, these actions do lead to numerical stability as mentioned at <strong>survival</strong> Rpackage details. For more about proportional hazards models see Klein and Moeschberger(2006).</p>

<pre><code>larynx$age &lt;- scale(larynx$age, scale = F)
larynx$stage2 = scale(as.numeric(larynx$stage == 2), scale = F)
larynx$stage3 = scale(as.numeric(larynx$stage == 3), scale = F)
larynx$stage4 = scale(as.numeric(larynx$stage == 4), scale = F)

## [1] &quot;env0&quot;
## character(0)
## [1] &quot;survival&quot; &quot;KMsurv&quot;
</code></pre>

<table style="width:93%;">
<caption>Fitting Proportional Hazards Regression Model: Surv(larynx<span class="math inline"><em>t</em><em>i</em><em>m</em><em>e</em>, <em>l</em><em>a</em><em>r</em><em>y</em><em>n</em><em>x</em></span>delta) ~ age + stage2 + stage3 + stage4</caption>
<colgroup>
<col width="18%" />
<col width="13%" />
<col width="16%" />
<col width="15%" />
<col width="12%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">coef</th>
<th align="center">exp(coef)</th>
<th align="center">se(coef)</th>
<th align="center">z</th>
<th align="center">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>age</strong></td>
<td align="center">0.01903</td>
<td align="center">1.019</td>
<td align="center">0.01426</td>
<td align="center">1.335</td>
<td align="center">0.182</td>
</tr>
<tr class="even">
<td align="center"><strong>stage2</strong></td>
<td align="center">0.14</td>
<td align="center">1.15</td>
<td align="center">0.4625</td>
<td align="center">0.3028</td>
<td align="center">0.762</td>
</tr>
<tr class="odd">
<td align="center"><strong>stage3</strong></td>
<td align="center">0.6424</td>
<td align="center">1.901</td>
<td align="center">0.3561</td>
<td align="center">1.804</td>
<td align="center">0.07125</td>
</tr>
<tr class="even">
<td align="center"><strong>stage4</strong></td>
<td align="center">1.706</td>
<td align="center">5.507</td>
<td align="center">0.4219</td>
<td align="center">4.043</td>
<td align="center">0.00005267</td>
</tr>
</tbody>
</table>

<p>Likelihood ratio test=18.31 on 4 df, p=0.001072 n= 90, number of events= 50</p>

<h2 id="bernstein-polynomials-and-log-likelihood-function">Bernstein polynomials and Log-likelihood function</h2>

<p>BP is often used to aproximate functions in close intervals $[a,b]$, according to Osman and Gosh (2012), it can be used as well to approximate cumulative hazard functions in $[0,  \tau ]$, such that $\tau$ is the time which there is no more survivers, i.e. we assume no cure fraction.</p>

<p>Basic notations, see Osman and Gosh (2012) for more:</p>

<p><img src="img/b01.png" alt="" /></p>

<ul>
<li><p>B is the polynomial that approximates the cumulative risk function. It is well known that partial (dot over B) gives us the risk function, see Klein and Moeschberger(2006).</p></li>

<li><p>Quantities in red appeared after applying derivate w/ respect to t. Note that those are given according to the summation index k and from here and forth are parameters to be estimated. In blue there is a beta density over  $\tau$  evaluated at $t/ \tau$ , denoted by g.</p></li>

<li><p>Getting H back consists of accumulating hazard function $h()$ from 0 to t. This ends up following beta cumulative density eval at $t/ \tau$, after a rearrangement trick.</p></li>

<li><p>We used b and B for polynomials basis instead of g and G on code.</p></li>
</ul>

<pre><code class="language-r">function (time, m = 0, tau = 0) 
{
   n &lt;- length(time)
   if (sum(time &gt;= 0) != n | m &lt; 0 | tau &lt; 0) {
       return(NA)
       break
   }
   if (tau == 0) {
       tau &lt;- max(time)
   }
   if (m == 0) {
       m &lt;- ceiling(sqrt(length(time)))
   }
   k &lt;- 1:m
   b &lt;- matrix(NA, n, m)
   B &lt;- matrix(NA, n, m)
   y &lt;- time/tau
   for (i in 1:n) {
       for (k in 1:m) {
           b[i, k] &lt;- dbeta(y[i], k, m - k + 1)/tau
           B[i, k] &lt;- pbeta(y[i], k, m - k + 1)
       }
   }
   return(list(b = b, B = B, m = m, tau = tau))
}
</code></pre>

<p>Above one could use sapply function instead of nested <code>for</code> loops. However, I opted to make a more intelligible code. Unlike the Cox model, the proposed approach does not use partial likelihood.</p>

<p><img src="img/b02.png" alt="" /></p>

<pre><code class="language-r">function (par, m, delta, Z, b, B) 
{
   gamma &lt;- abs(matrix(par[1:m], ncol = 1))
   beta &lt;- matrix(par[(m + 1):(m + q)], ncol = 1)
   q &lt;- length(par) - m
   eta &lt;- Z %*% beta
   h &lt;- b %*% gamma
   H &lt;- B %*% gamma
   res &lt;- sum(delta * log(h * exp(eta)) - H * exp(eta))
   return(res)
}
</code></pre>

<p>Classical inference was made using <code>BFGS</code> numeric optimization to find the argument (gamma, beta) that maximizes log-likelihood.</p>

<h2 id="proportional-hazards-model-related-functions-using-bp">Proportional hazards model related functions using BP</h2>

<p>Curves derived from gamma vector estimates obtained with <code>clas$par</code>.</p>

<p><img src="img/unnamed-chunk-5-1.png" alt="" /></p>

<h2 id="bayesian-approach">Bayesian Approach</h2>

<p>Bayesian inference wasn&rsquo;t as straight forward as using numerical methods already implemented in R. But it was elegantly done based on gibbs sampling and Adaptive Rejection Metropolis Sampling (ARMS) algorithm. In general, after sampling directly from posterior distribution, Bayesian estimators are calculated for each iteration risk curve.</p>

<p>However, when sampling from multivariate posterior is not possible, it is usual to sample from posterior conditionals distributions on Gibbs sampling. Even if sampling from conditionals is not possible, there are some alternatives, we recurred to Adaptive Rejection Metropolis Sampling (ARMS) within Gibbs. One can&rsquo;t know, but ARMS requires a grid delimiting the aimed density support, we used <strong>HI</strong> package <code>arms</code> function and Jacobian variable transformation to push all variables in [0,1]. See whole Rscript at gibbs.R repository file.</p>

<pre><code class="language-r"># priors parameters (hyperparameters)

a_gammak = .01
b_gammak = .01

a_gammak / b_gammak
</code></pre>

<pre><code>## [1] 1
</code></pre>

<pre><code class="language-r">a_gammak / (b_gammak)^2
</code></pre>

<pre><code>## [1] 100
</code></pre>

<pre><code class="language-r">m_beta &lt;- rep(0, q)
S_beta &lt;- diag(100, q, q)

it &lt;- 1e4

begtime &lt;- Sys.time()
source(&quot;gibbs.R&quot;)
library(coda)
Sys.time() - begtime
</code></pre>

<pre><code>## Time difference of 58.96 secs
</code></pre>

<pre><code class="language-r">burnin &lt;- .5 * it
par_mcmc &lt;- as.mcmc(par_samp[burnin:it, ])

par(mfrow = c(4,4))
traceplot(par_mcmc)
par(mfrow = c(4,4))
</code></pre>

<p><img src="img/unnamed-chunk-6-1.png" alt="" /></p>

<h2 id="estimates-using-bp">Estimates using BP</h2>

<table>
<colgroup>
<col width="18%" />
<col width="20%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center"> </th>
<th align="center">lower</th>
<th align="center">upper</th>
<th align="center">mean</th>
<th align="center">median</th>
<th align="center">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>gamma1</strong></td>
<td align="center">0.09565</td>
<td align="center">0</td>
<td align="center">0.2332</td>
<td align="center">0.1069</td>
<td align="center">0.1018</td>
<td align="center">0.0732</td>
</tr>
<tr class="even">
<td align="center"><strong>gamma2</strong></td>
<td align="center">-0.236</td>
<td align="center">0</td>
<td align="center">0.3944</td>
<td align="center">0.159</td>
<td align="center">0.1374</td>
<td align="center">0.133</td>
</tr>
<tr class="odd">
<td align="center"><strong>gamma3</strong></td>
<td align="center">0.000006972</td>
<td align="center">0</td>
<td align="center">0.3095</td>
<td align="center">0.088</td>
<td align="center">0.0441</td>
<td align="center">0.1045</td>
</tr>
<tr class="even">
<td align="center"><strong>gamma4</strong></td>
<td align="center">0.07928</td>
<td align="center">0</td>
<td align="center">0.3754</td>
<td align="center">0.1042</td>
<td align="center">0.0505</td>
<td align="center">0.1239</td>
</tr>
<tr class="odd">
<td align="center"><strong>gamma5</strong></td>
<td align="center">0.2653</td>
<td align="center">0</td>
<td align="center">0.4719</td>
<td align="center">0.1412</td>
<td align="center">0.0779</td>
<td align="center">0.1581</td>
</tr>
<tr class="even">
<td align="center"><strong>gamma6</strong></td>
<td align="center">0.00003381</td>
<td align="center">0</td>
<td align="center">0.727</td>
<td align="center">0.2322</td>
<td align="center">0.1412</td>
<td align="center">0.2434</td>
</tr>
<tr class="odd">
<td align="center"><strong>gamma7</strong></td>
<td align="center">0.7544</td>
<td align="center">0</td>
<td align="center">0.8949</td>
<td align="center">0.2924</td>
<td align="center">0.1966</td>
<td align="center">0.2875</td>
</tr>
<tr class="even">
<td align="center"><strong>gamma8</strong></td>
<td align="center">0.00001158</td>
<td align="center">0</td>
<td align="center">0.9374</td>
<td align="center">0.2941</td>
<td align="center">0.1854</td>
<td align="center">0.3083</td>
</tr>
<tr class="odd">
<td align="center"><strong>gamma9</strong></td>
<td align="center">-0.000005073</td>
<td align="center">0</td>
<td align="center">0.8511</td>
<td align="center">0.2468</td>
<td align="center">0.145</td>
<td align="center">0.2968</td>
</tr>
<tr class="even">
<td align="center"><strong>gamma10</strong></td>
<td align="center">0.000002499</td>
<td align="center">0</td>
<td align="center">0.9865</td>
<td align="center">0.2772</td>
<td align="center">0.1564</td>
<td align="center">0.3613</td>
</tr>
<tr class="odd">
<td align="center"><strong>beta1</strong></td>
<td align="center">0.01927</td>
<td align="center">-0.008</td>
<td align="center">0.0468</td>
<td align="center">0.0201</td>
<td align="center">0.0198</td>
<td align="center">0.0141</td>
</tr>
<tr class="even">
<td align="center"><strong>beta2</strong></td>
<td align="center">0.1719</td>
<td align="center">-0.7233</td>
<td align="center">1.071</td>
<td align="center">0.159</td>
<td align="center">0.1702</td>
<td align="center">0.4553</td>
</tr>
<tr class="odd">
<td align="center"><strong>beta3</strong></td>
<td align="center">0.6585</td>
<td align="center">-0.0427</td>
<td align="center">1.309</td>
<td align="center">0.6505</td>
<td align="center">0.6472</td>
<td align="center">0.3449</td>
</tr>
<tr class="even">
<td align="center"><strong>beta4</strong></td>
<td align="center">1.799</td>
<td align="center">0.9948</td>
<td align="center">2.668</td>
<td align="center">1.795</td>
<td align="center">1.805</td>
<td align="center">0.4319</td>
</tr>
</tbody>
</table>

<h2 id="base-cumulative-risk-and-base-survival-curves">Base cumulative risk and base survival curves</h2>

<p><img src="img/unnamed-chunk-8-1.png" alt="" /></p>

<h2 id="survival-curves-by-groups-for-a-given-77-years-old-patient">Survival curves by groups for a given 77 years old patient</h2>

<p><img src="img/unnamed-chunk-9-1.png" alt="" /></p>

<h2 id="bayesian-using-rstan-no-u-turn-sampler">Bayesian using Rstan (No-U-Turn Sampler)</h2>

<p>Stan is a state-of-the-art platform for statistical modeling, an alternative to Gibbs Sampling seen above.</p>

<pre><code class="language-r"># Clear the R workspace and load rstan. # rm(list=ls(all=TRUE))
library(rstan)

# avoid recompilations
rstan_options(auto_write = TRUE)

# run different chains in parallel.
options(mc.cores = parallel::detectCores())

# Prepare data for Stan
data = list(n = n, m = m, q = q, delta = larynx$delta,
            Z = Z, B = base$B, b = base$b,
            a_gammak = a_gammak, b_gammak = b_gammak,
            m_beta = m_beta[1], S_beta = S_beta[1])

pars = c(&quot;beta&quot;,&quot;gamma&quot;)

initvals = &quot;random&quot;

iter = it # total iterations (including warm-up).
warmup = it * .5
chains = 1

begtime &lt;- Sys.time()
output = stan(file = &quot;bern.stan&quot;, data=data,
              iter=iter, warmup=warmup, chains=chains,
              pars=pars, init=initvals, verbose=FALSE)
</code></pre>

<pre><code>## 
## SAMPLING FOR MODEL 'bern' NOW (CHAIN 1).
## Chain 1: 
## Chain 1: Gradient evaluation took 5.1e-05 seconds
## Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.51 seconds.
## Chain 1: Adjust your expectations accordingly!
## Chain 1: 
## Chain 1: 
## Chain 1: Iteration:    1 / 10000 [  0%]  (Warmup)
## Chain 1: Iteration: 1000 / 10000 [ 10%]  (Warmup)
## Chain 1: Iteration: 2000 / 10000 [ 20%]  (Warmup)
## Chain 1: Iteration: 3000 / 10000 [ 30%]  (Warmup)
## Chain 1: Iteration: 4000 / 10000 [ 40%]  (Warmup)
## Chain 1: Iteration: 5000 / 10000 [ 50%]  (Warmup)
## Chain 1: Iteration: 5001 / 10000 [ 50%]  (Sampling)
## Chain 1: Iteration: 6000 / 10000 [ 60%]  (Sampling)
## Chain 1: Iteration: 7000 / 10000 [ 70%]  (Sampling)
## Chain 1: Iteration: 8000 / 10000 [ 80%]  (Sampling)
## Chain 1: Iteration: 9000 / 10000 [ 90%]  (Sampling)
## Chain 1: Iteration: 10000 / 10000 [100%]  (Sampling)
## Chain 1: 
## Chain 1:  Elapsed Time: 98.5036 seconds (Warm-up)
## Chain 1:                138.742 seconds (Sampling)
## Chain 1:                237.245 seconds (Total)
## Chain 1:
</code></pre>

<pre><code class="language-r">Sys.time()-begtime
</code></pre>

<pre><code>## Time difference of 3.981 mins
</code></pre>

<pre><code class="language-r">traceplot(output, pars=c(&quot;beta&quot;,&quot;gamma&quot;))
</code></pre>

<p><img src="img/unnamed-chunk-10-1.png" alt="" /></p>

<table>
<colgroup>
<col width="18%" />
<col width="20%" />
<col width="13%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center"> </th>
<th align="center">lower</th>
<th align="center">upper</th>
<th align="center">mean</th>
<th align="center">median</th>
<th align="center">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>gamma1</strong></td>
<td align="center">0.09565</td>
<td align="center">0</td>
<td align="center">0.0725</td>
<td align="center">0.0087</td>
<td align="center">0</td>
<td align="center">0.0341</td>
</tr>
<tr class="even">
<td align="center"><strong>gamma2</strong></td>
<td align="center">-0.236</td>
<td align="center">0.1786</td>
<td align="center">0.5698</td>
<td align="center">0.3782</td>
<td align="center">0.38</td>
<td align="center">0.0996</td>
</tr>
<tr class="odd">
<td align="center"><strong>gamma3</strong></td>
<td align="center">0.000006972</td>
<td align="center">0</td>
<td align="center">0.0014</td>
<td align="center">0.0022</td>
<td align="center">0</td>
<td align="center">0.0171</td>
</tr>
<tr class="even">
<td align="center"><strong>gamma4</strong></td>
<td align="center">0.07928</td>
<td align="center">0</td>
<td align="center">0.003</td>
<td align="center">0.0041</td>
<td align="center">0</td>
<td align="center">0.0269</td>
</tr>
<tr class="odd">
<td align="center"><strong>gamma5</strong></td>
<td align="center">0.2653</td>
<td align="center">0</td>
<td align="center">0.1752</td>
<td align="center">0.0294</td>
<td align="center">0</td>
<td align="center">0.1303</td>
</tr>
<tr class="even">
<td align="center"><strong>gamma6</strong></td>
<td align="center">0.00003381</td>
<td align="center">0</td>
<td align="center">1.183</td>
<td align="center">0.5155</td>
<td align="center">0.6279</td>
<td align="center">0.4486</td>
</tr>
<tr class="odd">
<td align="center"><strong>gamma7</strong></td>
<td align="center">0.7544</td>
<td align="center">0</td>
<td align="center">1.412</td>
<td align="center">0.3649</td>
<td align="center">0</td>
<td align="center">0.5334</td>
</tr>
<tr class="even">
<td align="center"><strong>gamma8</strong></td>
<td align="center">0.00001158</td>
<td align="center">0</td>
<td align="center">0.0965</td>
<td align="center">0.0437</td>
<td align="center">0</td>
<td align="center">0.2267</td>
</tr>
<tr class="odd">
<td align="center"><strong>gamma9</strong></td>
<td align="center">-0.000005073</td>
<td align="center">0</td>
<td align="center">0.0047</td>
<td align="center">0.0123</td>
<td align="center">0</td>
<td align="center">0.1016</td>
</tr>
<tr class="even">
<td align="center"><strong>gamma10</strong></td>
<td align="center">0.000002499</td>
<td align="center">0</td>
<td align="center">0.0046</td>
<td align="center">0.0109</td>
<td align="center">0</td>
<td align="center">0.1031</td>
</tr>
<tr class="odd">
<td align="center"><strong>beta1</strong></td>
<td align="center">0.01927</td>
<td align="center">-0.0074</td>
<td align="center">0.0483</td>
<td align="center">0.0193</td>
<td align="center">0.0192</td>
<td align="center">0.0142</td>
</tr>
<tr class="even">
<td align="center"><strong>beta2</strong></td>
<td align="center">0.1719</td>
<td align="center">-0.8207</td>
<td align="center">1.054</td>
<td align="center">0.1133</td>
<td align="center">0.1259</td>
<td align="center">0.482</td>
</tr>
<tr class="odd">
<td align="center"><strong>beta3</strong></td>
<td align="center">0.6585</td>
<td align="center">0.015</td>
<td align="center">1.415</td>
<td align="center">0.6704</td>
<td align="center">0.6643</td>
<td align="center">0.3555</td>
</tr>
<tr class="even">
<td align="center"><strong>beta4</strong></td>
<td align="center">1.799</td>
<td align="center">0.9267</td>
<td align="center">2.647</td>
<td align="center">1.808</td>
<td align="center">1.815</td>
<td align="center">0.4369</td>
</tr>
</tbody>
</table>

<h2 id="future-work">Future Work</h2>

<p>Investigate and deal with suspicion of cure fraction present in dataset and explore the use of BP for Cox model extensions. In addition to that, a Rpackage will be released to wrap a wide variety of survival models using BP by the end of the year as part of my MSc final project.</p>

<h2 id="references">References</h2>

<ul>
<li><p>Giolo, S. R., &amp; Colosimo, E. A. (2006). Análise de sobrevivência aplicada. Edgard Blucher.</p></li>

<li><p>Ibrahim, J. G., Chen, M. H., &amp; Sinha, D. (2001). Bayesian survival analysis. Springer Science &amp; Business Media.</p></li>

<li><p>Klein, J. P., &amp; Moeschberger, M. L. (2006). Survival analysis: techniques for censored and truncated data. Springer Science &amp; Business Media.</p></li>

<li><p>Lorentz, G. G. (2012). Bernstein polynomials. American Mathematical Soc..</p></li>

<li><p>Osman, M., &amp; Ghosh, S. K. (2012). Nonparametric regression models for right-censored data using Bernstein polynomials. Computational Statistics &amp; Data Analysis, 56(3), 559-573.</p></li>
</ul>

    </div>

    


<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/survival-analysis/">Survival Analysis</a>
  
  <a class="badge badge-light" href="/tags/stan/">Stan</a>
  
  <a class="badge badge-light" href="/tags/bayesian/">Bayesian</a>
  
  <a class="badge badge-light" href="/tags/bernstein-polynomials/">Bernstein polynomials</a>
  
</div>



    






<div class="media author-card" itemscope itemtype="http://schema.org/Person">
  
  <img class="portrait mr-3" src="/img/portrait.jpg" itemprop="image" alt="Avatar">
  
  <div class="media-body">
    <h5 class="card-title" itemprop="name"><a href="/">Renato Valladares Panaro</a></h5>
    <h6 class="card-subtitle">Statistician, M.S. Student</h6>
    
    <ul class="network-icon" aria-hidden="true">
      
      
      
      
        
      
      
      
      
      
      <li>
        <a itemprop="sameAs" href="mailto:renatovp@id.uff.br" >
          <i class="fas fa-envelope"></i>
        </a>
      </li>
      
      
      
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="http://lattes.cnpq.br/6491127183861836" target="_blank" rel="noopener">
          <i class="ai ai-lattes"></i>
        </a>
      </li>
      
      
      
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://orcid.org/0000-0002-1903-2091" target="_blank" rel="noopener">
          <i class="ai ai-orcid"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://www.linkedin.com/in/rvpanaro/" target="_blank" rel="noopener">
          <i class="fab fa-linkedin"></i>
        </a>
      </li>
      
      
      
      
        
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="https://github.com/rvpanaro" target="_blank" rel="noopener">
          <i class="fab fa-github"></i>
        </a>
      </li>
      
      
      
      
      
      
      
      
        
      
      <li>
        <a itemprop="sameAs" href="/CV/cv.pdf" >
          <i class="ai ai-cv"></i>
        </a>
      </li>
      
    </ul>
  </div>
</div>




    
    

    

  </div>
</article>


<div class="article-container article-widget">
  <div class="post-nav">
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Previous</div>
    <a href="/project/external-project/" rel="prev">R para n00bs</a>
  </div>
  
</div>

</div>


<div class="container">
  <footer class="site-footer">
  
  <p class="powered-by">
    <a href="/privacy/">Intellectual Property and Privacy Policy</a>
  </p>
  

  <p class="powered-by">
    &copy; 2018 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" id="back_to_top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

</div>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    
    
    <script src="/js/mathjax-config.js"></script>
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha512-+NqPlbbtM1QqiK8ZAo4Yrj2c4lNQoGv8P79DPtKzj++l5jnN39rHA/xsqn8zE9l0uSoxaCdrOgFs6yjyfbBxSg==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha256-VsEqElsCHSGmnmHXGQzvoWjWwoznFSZc6hs7ARLRacQ=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
        
      

      
      
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-AMS_CHTML-full" integrity="sha256-GhM+5JHb6QUzOQPXSJLEWP7R73CbkisjzK5Eyij4U9w=" crossorigin="anonymous" async></script>
      
    

    
    

    
    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    

    
    

    

    
    

    
    

    
    
    
    
    
    
    
    
    <script src="/js/academic.min.d037ee5294b166a79dec317c58aea9cc.js"></script>

    

  </body>
</html>

